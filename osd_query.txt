select ccc_code, 
GOVT_STAT,
CASE
WHEN CONN_STAT IN ('LIVE') THEN 'Live'
WHEN CONN_STAT IN ('TEMPORARY DISCONNECTED') THEN 'TD'
WHEN CONN_STAT IN ('PERMANENT DISCONNECTED') THEN 'PD'
ELSE 'DD'
END AS DIS_STAT,
CASE
WHEN OUTSTANDING > 50 THEN 'OSD'
ELSE 'NO_OSD'
END  AS OSD_REMARK,
case
WHEN CONN_STAT='LIVE' OR CONN_STAT='TEMPORARY DISCONNECTED' THEN 'LIVE'
WHEN CONN_STAT='DEEMED DISCONNECTED' THEN 'DD'
ELSE 'OTHERS' 
END AS CONN_STAT,
CASE
WHEN BASE_CLASS='D' AND GOVT_STAT='NO' THEN 'D'
WHEN BASE_CLASS='C' AND GOVT_STAT='NO' THEN 'C'
WHEN BASE_CLASS='I' AND GOVT_STAT='NO' THEN 'I'
WHEN BASE_CLASS='A' AND GOVT_STAT='NO' THEN 'A'
WHEN NAT_OF_CONN IN ('AGRI IRRI.', 'AGRI MECH') AND GOVT_STAT='YES' THEN 'DTW'
WHEN BASE_CLASS='A' AND GOVT_STAT='YES' and NAT_OF_CONN NOT IN ('AGRI IRRI.', 'AGRI MECH', 'GRAM PANCHAYET')THEN 'STW'
WHEN NAT_OF_CONN='PHE' AND GOVT_STAT='YES'THEN 'PHE'
WHEN BASE_CLASS='H' AND NAT_OF_CONN IN ('Municipality', 'GRAM PANCHAYET') AND GOVT_STAT='YES' THEN 'STR'
WHEN BASE_CLASS<>'H' AND NAT_OF_CONN IN ('Municipality', 'GRAM PANCHAYET') AND GOVT_STAT='YES' THEN 'MUNI'
WHEN BASE_CLASS NOT IN ('D', 'C', 'I', 'A') AND GOVT_STAT='NO' THEN 'O'
--WHEN NAT_OF_CONN NOT IN ('AGRI IRRI.', 'AGRI MECH', 'Municipality', 'GRAM PANCHAYET', 'PHE') AND GOVT_STAT='YES' AND BASE_CLASS NOT IN ('A', 'H') THEN 'OTH'
ELSE 'OTH'
END AS TYPE,
case
when outstanding>100000 AND CONN_STAT='LIVE' AND GOVT_STAT='NO' then 'osd_lakh'
when outstanding>50000 AND CONN_STAT='LIVE' AND GOVT_STAT='NO' then 'osd_50K'
when outstanding>10000 AND CONN_STAT='LIVE' AND GOVT_STAT='NO' then 'osd_10K'
when outstanding>5000 AND CONN_STAT='LIVE' AND GOVT_STAT='NO' then 'osd_5K'
end OSD_SLAB,
count(distinct con_id) count, SUM(OUTSTANDING) OSD
FROM ISUDATA.REP_BIZ_MASTER_dETAIL
WHERE SUBSTR(CCC_CODE,1,4) IN ('3157','3155','3113','3122','3153','3152','3125')
GROUP BY ccc_code, CONN_STAT, BASE_CLASS, NAT_OF_CONN, govt_stat, OUTSTANDING